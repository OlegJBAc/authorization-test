(function(){"use strict";var t={2650:function(t,a,e){var n=e(9242),o=e(3396);const r={class:"app"};function u(t,a,e,n,u,s){const i=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(i,{onLogIn:t.logIn,onLogOut:t.logOut},null,8,["onLogIn","onLogOut"])])}var s=e(65),i={name:"App",methods:{...(0,s.nv)({meCheck:"auth/meCheck"})},beforeMount(){this.meCheck()}},c=e(89);const l=(0,c.Z)(i,[["render",u]]);var d=l,p=e(7139);const h=t=>((0,o.dD)("data-v-34f8a070"),t=t(),(0,o.Cn)(),t),m={class:"main"},f={class:"main__title"},v={class:"main__header"},g={class:"main__logout"},w=h((()=>(0,o._)("span",null,"Logout",-1)));function _(t,a,e,n,r,u){const s=(0,o.up)("myButton");return(0,o.wg)(),(0,o.iD)("div",m,[(0,o._)("div",f,[(0,o._)("div",v,"Hi, "+(0,p.zw)(t.$store.state.auth.authData.login)+" is test authorized page",1)]),(0,o._)("div",g,[(0,o.Wm)(s,{id:"btn__main",onClick:a[0]||(a[0]=a=>t.$store.dispatch("auth/logOut"))},{default:(0,o.w5)((()=>[w])),_:1})])])}var D={data(){},methods:{...(0,s.nv)({logOut:"auth/logOut"})}};const b=(0,c.Z)(D,[["render",_],["__scopeId","data-v-34f8a070"]]);var y=b;const C={class:"form"},I={class:"input__wrapper"},k={class:"input__wrapper"},L={class:"input__wrapper"},U={key:0},O=["src"],V={key:1,class:"input__wrapper"},R={key:2,class:"auth__error"};function A(t,a,e,n,r,u){const s=(0,o.up)("myInput"),i=(0,o.up)("myButton");return(0,o.wg)(),(0,o.iD)("form",C,[(0,o._)("div",I,[(0,o.Wm)(s,{type:"email",placeholder:"Enter your email...",required:"",modelValue:r.authData.email,"onUpdate:modelValue":a[0]||(a[0]=t=>r.authData.email=t)},null,8,["modelValue"])]),(0,o._)("div",k,[(0,o.Wm)(s,{type:"password",placeholder:"Enter your password...",required:"",modelValue:r.authData.password,"onUpdate:modelValue":a[1]||(a[1]=t=>r.authData.password=t)},null,8,["modelValue"])]),(0,o._)("div",L,[(0,o.Wm)(s,{type:"password",placeholder:"Confirm your password",required:"",modelValue:r.authData.passwordConfirmation,"onUpdate:modelValue":a[2]||(a[2]=t=>r.authData.passwordConfirmation=t)},null,8,["modelValue"])]),t.$store.state.auth.captchaURL?((0,o.wg)(),(0,o.iD)("div",U,[(0,o._)("img",{src:r.captchaURL},null,8,O)])):(0,o.kq)("",!0),t.$store.state.auth.captchaURL?((0,o.wg)(),(0,o.iD)("div",V,[(0,o.Wm)(s,{placeholder:"enter captcha",modelValue:r.captcha,"onUpdate:modelValue":a[3]||(a[3]=t=>r.captcha=t)},null,8,["modelValue"])])):(0,o.kq)("",!0),(0,o.Wm)(i,{class:"btn",onClick:u.logInFunc},{default:(0,o.w5)((()=>[(0,o.Uk)("LogIn")])),_:1},8,["onClick"]),null!==r.authData.error?((0,o.wg)(),(0,o.iD)("h3",R,(0,p.zw)(r.authData.error),1)):(0,o.kq)("",!0)])}var M={data(){return{authData:{email:"",password:"",passwordConfirmation:"",rememberMe:!0,error:null},captcha:null,captchaURL:null}},methods:{...(0,s.nv)({logIn:"auth/logIn",getCaptchaURL:"auth/getCaptchaURL"}),logInFunc(){this.authData.password===this.authData.passwordConfirmation?this.logIn({email:this.authData.email,password:this.authData.password,rememberMe:this.authData.rememberMe,captcha:this.captcha}).then((t=>{10===t&&this.getCaptchaURL().then((t=>{this.captchaURL=t,this.authData.error=""})),null!==t&&10!==t&&(this.authData.error=t)})):this.authData.error="Invalid confirmation password"}}};const W=(0,c.Z)(M,[["render",A],["__scopeId","data-v-0c9f69e9"]]);var j=W,P=e(2483);const q=[{path:"/main",component:y},{path:"/login",component:j}],Z=(0,P.p7)({routes:q,history:(0,P.r5)("/")});var $=Z,x=(e(7658),e(6943));const E=x.Z.create({baseURL:"https://social-network.samuraijs.com/api/1.0",withCredentials:!0,headers:{"API-KEY":"ebf536e3-3303-498b-b5bb-6080ca866d8c"}});var z=E;const B=t=>t>=200<400?null:t>=400<500?"ошибка клиента, проверьте правильность введённых данных":t>=500?"ошибка сервера, попробуйте авторизоваться позднее":void 0;var F=B;const T={state:{authData:{isAuth:!1,login:"",userId:0},captchaURL:null},mutations:{setAuthData(t,a){t.authData={...a}},setCaptchaURL(t,a){t.captchaURL=a}},actions:{async meCheck(t){const a=await z.get("/auth/me"),e=a.data.resultCode;if(0!==e)return new Promise(((t,e)=>{t(F(a.status))}));t.commit("setAuthData",{isAuth:!0,login:a.data.data.login,userId:a.data.data.id}),$.push("/main")},async logIn(t,{email:a,password:e,rememberMe:n,captcha:o=null}){const r=await z.post("/auth/login",{email:a,password:e,rememberMe:n,captcha:o});if(0!==r.data.resultCode)return new Promise(((t,a)=>{10===r.data.resultCode?t(10):t(r.data.messages[0])}));t.dispatch("meCheck")},async logOut(t){const a=await z["delete"]("/auth/login");if(0!==a.data.resultCode)return new Promise(((t,e)=>{t(F(a.status))}));t.commit("setAuthData",{isAuth:!1,login:"",userId:0}),$.push("/login")},async getCaptchaURL(t){const a=await z.get("/security/get-captcha-url");return t.commit("setCaptchaURL",a.data),new Promise(((t,e)=>{t(a.data.url)}))}},namespaced:!0};var H=T,K=(0,s.MT)({modules:{auth:H}});const N=["value"];function S(t,a,e,n,r,u){return(0,o.wg)(),(0,o.iD)("input",{value:e.modelValue,onInput:a[0]||(a[0]=(...t)=>u.updateInput&&u.updateInput(...t)),type:"text",class:"input"},null,40,N)}var Y={name:"myInput",props:{modelValue:[String,Number]},methods:{updateInput(t){this.$emit("update:modelValue",t.target.value)}}};const G=(0,c.Z)(Y,[["render",S],["__scopeId","data-v-2fcaa1bf"]]);var J=G;const Q={class:"btn"};function X(t,a,e,n,r,u){return(0,o.wg)(),(0,o.iD)("button",Q,[(0,o.WI)(t.$slots,"default",{},void 0,!0)])}var tt={name:"myButton"};const at=(0,c.Z)(tt,[["render",X],["__scopeId","data-v-076c43e6"]]);var et=at,nt=[J,et];const ot=(0,n.ri)(d);nt.forEach((t=>{ot.component(t.name,t)})),ot.use($).use(K).mount("#app")}},a={};function e(n){var o=a[n];if(void 0!==o)return o.exports;var r=a[n]={exports:{}};return t[n](r,r.exports,e),r.exports}e.m=t,function(){var t=[];e.O=function(a,n,o,r){if(!n){var u=1/0;for(l=0;l<t.length;l++){n=t[l][0],o=t[l][1],r=t[l][2];for(var s=!0,i=0;i<n.length;i++)(!1&r||u>=r)&&Object.keys(e.O).every((function(t){return e.O[t](n[i])}))?n.splice(i--,1):(s=!1,r<u&&(u=r));if(s){t.splice(l--,1);var c=o();void 0!==c&&(a=c)}}return a}r=r||0;for(var l=t.length;l>0&&t[l-1][2]>r;l--)t[l]=t[l-1];t[l]=[n,o,r]}}(),function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}}(),function(){e.d=function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){var t={143:0};e.O.j=function(a){return 0===t[a]};var a=function(a,n){var o,r,u=n[0],s=n[1],i=n[2],c=0;if(u.some((function(a){return 0!==t[a]}))){for(o in s)e.o(s,o)&&(e.m[o]=s[o]);if(i)var l=i(e)}for(a&&a(n);c<u.length;c++)r=u[c],e.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return e.O(l)},n=self["webpackChunkauth_test"]=self["webpackChunkauth_test"]||[];n.forEach(a.bind(null,0)),n.push=a.bind(null,n.push.bind(n))}();var n=e.O(void 0,[998],(function(){return e(2650)}));n=e.O(n)})();
//# sourceMappingURL=app.be406562.js.map